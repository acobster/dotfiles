# Navigational aliases
alias ..='upandaway 1'
alias ...='upandaway 2'
alias ....='upandaway 3'
alias .....='upandaway 4'
alias ......='upandaway 5'

upandaway() {
  if [[ $1 = 1 ]] ; then
    updir='../'
  elif [[ $1 = 2 ]] ; then
    updir='../../'
  elif [[ $1 = 3 ]] ; then
    updir='../../../'
  elif [[ $1 = 4 ]] ; then
    updir='../../../../'
  elif [[ $1 = 5 ]] ; then
    updir='../../../../../'
  fi

  cd "$updir$2"
}


# Utilities
alias b='build'
alias aliases='vim ~/dotfiles/.aliases'
alias al='vim ~/.aliases'
alias ssh-config='vim ~/.ssh/config'
alias dtf='cd ~/dotfiles'
alias x='xclip -selection clipboard'
alias la='ls -la'
alias lah='ls -lah'
alias lz='ls -Z'
alias drop='cd ~/Dropbox'
alias v='vim'
alias vimsess='ls ~/.vim/session'
alias vs='vimsess'
alias r='reload'
alias rr='reload && clear'
alias rrr='reload && cd && clear'
alias rmswp='find . -regextype sed -regex ".*\\.sw\(p\|o\|n\)" | xargs rm'
alias tdf='dtf && t dtf "vms dtf" "consume" "git status"'
alias tk='tmux kill-session -t'
alias tkall='tmux list-sessions | awk "{print \$1}" | sed "s/://" | while read sess; do tmux kill-session -t $sess; done'
alias tree='tree -a -I "vendor|node_modules|.git"'
alias minute='date +%Y%m%d%I%M'
alias hour='date +%Y%m%d%I'
alias day='date +%Y%m%d'
alias gigs='du . -h | grep "[0-9]\+\(\.[0-9]\+\)G"'
alias cpkey='cat ~/.ssh/id_ed25519.pub | x'

# programs
alias yt='yt-dlp'
alias extract='extract.clj'

# dirs
alias docs='cd ~/Sync/docs'
alias music='cd ~/Sync/music'
alias vids='cd ~/Sync/videos'
alias pics='cd ~/Sync/pictures'
alias movies='cd ~/Sync/movies'
alias shows='cd ~/Sync/shows'
alias tv='cd ~/Sync/shows'
alias dl='cd ~/Downloads'
alias desk='cd ~/Desktop'

# ID3 tags
alias ff='ffprobe -show_format -print_format json 2>/dev/null'
alias id3='id3.clj'

# Git stuff
alias g='git'
alias ha='git add --all -p'
alias st='git status'
alias aa='git add --all'
alias d='git diff'
# be nice to me when i make typos ok plz
alias tig='git'
alias gr='grep --exclude-dir=.git -r'

# Stack Exchange code snippetz
alias socode='sed "s/^/    /"|x'

# List snippets available within my dotfiles
alias snippets='ls ~/dotfiles/snippets'

alias nix-plasma='nix run github:nix-community/plasma-manager'

alias grepnix='grep --recursive --include="*.nix"'
alias grepcljx='grep --recursive --include="*.clj" --include="*.cljs" --include="*.cljc"'
alias grepcljxe='grep --recursive --include="*.clj" --include="*.cljs" --include="*.cljc" --include="*.edn"'
alias grepclj='grep --recursive --include="*.clj"'
alias grepcljc='grep --recursive --include="*.cljc"'
alias grepcljs='grep --recursive --include="*.cljs"'
alias grepy='grep --recursive --include="*.py"'
alias grepmd='grep --recursive --include="*.md"'
alias grephp='grep --recursive --include="*.php"'
alias grepjs='grep --recursive --include="*.js"'
alias grepts='grep --recursive --include="*.ts"'
alias greptsx='grep --recursive --include="*.ts" --include="*.tsx"'
alias grepscss='grep --recursive --include="*.scss"'
alias grepyaml='grep --recursive --include="*.yaml" --include="*.yml"'
alias grepsql='grep --recursive --include="*.sql"'
alias greptwig='grep --recursive --include="*.twig"'
alias grepless='grep --recursive --include="*.less"'

#--------------------
# Git functions
#--------------------

global_ignore() {
  echo "$1" >> ~/.gitignore
}


# Vim

vms() {
  if [[ -z $1 ]] ; then
    echo you gotta specify a session
  fi

  nvim -S ~/.vim/session/$1.vim
}


# Misc projects

proj() {
  if [[ -d "$HOME/projects/$1" ]] ; then
    cd "$HOME/projects/$1"
  else
    cd ~/projects
  fi
}


# WordPress

wp-html-dir() {
  root=`git root`
  if [[ -d $root/html/wp ]] ; then
    html=$root/html/wp
  elif [[ -d $root/html ]] ; then
    html=$root/html
  elif [[ -d $root/wp ]] ; then
    html=$root/wp
  elif [[ -f $root/wp-config.php ]] ; then
    html=$root
  fi
  echo $html
}

plugins() {
  echo 'deprecated! use `plugin` instead'
  cd $(wp-html-dir)/wp-content/plugins
}

plugin() {
  wp_root=$(wp-html-dir)
  if [[ -z "$wp_root" ]] ; then
    echo 'Not in a WordPress directory tree!'
    exit 1
  fi

  cd "$wp_root/wp-content/plugins/$1"
}

muplugin() {
  wp_root=$(wp-html-dir)
  if [[ -z "$wp_root" ]] ; then
    echo 'Not in a WordPress directory tree!'
    exit 1
  fi

  cd "$wp_root/wp-content/mu-plugins/$1"
}

wpthemes() {
  cd $(wp-html-dir)/wp-content/themes
}

wptheme() {
  theme=$(wp-html-dir)/wp-content/themes/$1
  if [[ -d "$theme" ]] ; then
    cd $theme
  elif [[ -d $(dirname "$theme") ]] ; then
    echo "No such theme: $1"
    cd $(dirname "$theme")
  else
    echo "Couldn't find themes directory. Are you in a WP directory tree?"
    exit 1
  fi
}

wpdebug() {
  cd $(wp-html-dir)/wp-content
  touch debug.log
  tail -f debug.log
}



#--------------------
# Assorted functions
#--------------------

reload() {
  if [[ -f $HOME/.bash_profile ]] ; then
    source $HOME/.bash_profile
  elif [[ -f $HOME/.bashrc ]] ; then
    source $HOME/.bashrc
  fi
}

gems() {
  gem query | grep "$1"
}

decode_url() {
  php -r "echo urldecode('$1').\"\n\";"
}

backup() {
  cp -r $1 $1.bak
}

mc() {
  mkdir -p "$1" && cd "$1"
}

psgrep() {
  ps aux | grep -i $1 | grep -v grep
}

portgrep() {
  sudo netstat -tulpn | grep $1 | grep -v grep
}

grepkill() {
  ps aux | grep $1 | grep -v grep | kill `awk '{print $2}'`
}
